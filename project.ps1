$applications = Get-WmiObject -class win32_product
$count=0

foreach ($c in $applications){

$check = $applications[$count].Name+", "+$applications[$count].version
$check = $check -replace ' ','+'
$check
$url = "https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=$check"
$HTML = Invoke-WebRequest -Uri $url
$output = $HTML.Links | ForEach-Object -MemberName innertext | Select-String "CVE-"
foreach ($_ in $output) {
#writing out each member of the object as a string that can be utilised by PS
$CVE = $_

$CVE = $CVE -replace "CVE", "rugby"
Write-Host $CVE
}











#$output = $HTML.Links | select href | Select-String "CVE-2" 
#$output = $output -replace '@{href=/cgi-bin/cvename.cgi?name=',' '
#Write-Host $output








$count++
}

echo ("$count")