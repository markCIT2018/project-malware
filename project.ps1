$applications = Get-WmiObject -class win32_product
$count=0

foreach ($c in $applications){

$check = $applications[$count].Name+", "+$applications[$count].version
$check = $check -replace ' ','+'
$check
$url = "https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=$check"
$HTML = Invoke-WebRequest -Uri $url
$output = $HTML.Links | ForEach-Object -MemberName innertext | Select-String "CVE-"
foreach ($_ in $output) {
#writing out each member of the object as a string that can be utilised by PS
$CVE = $_

$url2 = "https://nvd.nist.gov/vuln/search/results?form_type=Basic&results_type=overview&query=$CVE"
$html2 = Invoke-WebRequest -Uri $url2
$output2 = $html2.ParsedHtml.all.tags("td") | ForEach-Object -MemberName innertext


Write-Host $CVE
#Write-Host $output2
}
$count++
}