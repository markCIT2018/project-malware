
$env:HostIP = (
    Get-NetIPConfiguration |
    Where-Object {
        $_.IPv4DefaultGateway -ne $null -and
        $_.NetAdapter.Status -ne "Disconnected"
    }
).IPv4Address.IPAddress

Write-Host $env:HostIP

nmap -sV $env:HostIP -oA nmapoutput
$count = 0
[xml]$xmlDocument = Get-Content -Path C:\Windows\SysWOW64\nmapoutput.xml
foreach ($port in $xmlDocument.nmaprun.host.ports.port){
$service = [string]$xmlDocument.nmaprun.host.ports.port.service[$count].product
#$version = [string]$xmlDocument.nmaprun.host.ports.port.service[$count].version
$count++
}

write-host $version
write-host $service