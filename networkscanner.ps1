
$env:HostIP = (
    Get-NetIPConfiguration |
    Where-Object {
        $_.IPv4DefaultGateway -ne $null -and
        $_.NetAdapter.Status -ne "Disconnected"
    }
).IPv4Address.IPAddress

Write-Host $env:HostIP

nmap -sV $env:HostIP -oA nmapoutput
[xml]$xmlDocument = Get-Content -Path C:\Windows\SysWOW64\nmapoutput.xml
$port= $xmlDocument.nmaprun.host.ports.port.count
$count = 0

Write-Host `n
while($count -ne $port){

    $name = [string]$xmlDocument.nmaprun.host.ports.port.service.name[$count]
    $service = [string]$xmlDocument.nmaprun.host.ports.port.service[$count].product
    $version = [string]$xmlDocument.nmaprun.host.ports.port.service[$count].version

    

    if ($service.Length -eq 0 ){
        $service = $name
        write-host $service
    }else {
        write-host $service
    }

    if ($version.Length -eq 0 ){

    }else{
        write-host $version
    }

    $count++
}

