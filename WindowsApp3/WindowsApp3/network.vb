Public Class network

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        If My.Computer.FileSystem.FileExists("network_vuln.csv") Then
            Process.Start("powershell", "remove-item network_vuln.csv")

        End If


        Dim value As String
        value = ComboBox1.Text


        If (value = "Vulnerabilties per Network") Then
            MsgBox("Please Select a numeric value")
        Else
            Process.Start("powershell", "new-item -path $pwd\default\net.txt")
            Dim objWriter As New System.IO.StreamWriter("default\net.txt")
            objWriter.Write(value)
            objWriter.Close()
            Process.Start("powershell", "-noexit  -ExecutionPolicy Bypass -File networkscanner.ps1")
        End If

    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        If My.Computer.FileSystem.FileExists("network_vuln.csv") Then
            Process.Start("powershell", "remove-item network_vuln.csv")

        End If

        Dim value As String
        value = ComboBox1.Text


        If (value = "Vulnerabilties per Network") Then
            MsgBox("Please Select a numeric value")
        Else
            Process.Start("powershell", "new-item -path $pwd\default\net.txt")
            Dim objWriter As New System.IO.StreamWriter("default\net.txt")
            objWriter.Write(value)
            objWriter.Close()
            Process.Start("powershell", "-windowstyle hidden -noexit  -ExecutionPolicy Bypass -File networkscanner.ps1")
        End If

    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Network_database.Show()
        Me.Hide()

        Network_database.DataGridView1.Rows.Clear()
        Dim fName As String = "network_vuln.csv"

        Dim TextLine As String = ""
        Dim SplitLine() As String
        If System.IO.File.Exists(fName) = True Then
            Dim objReader As New System.IO.StreamReader(fName)
            Do While objReader.Peek() <> -1
                TextLine = objReader.ReadLine()
                SplitLine = Split(TextLine, ",")
                Network_database.DataGridView1.Rows.Add(SplitLine)
            Loop
        Else
            MsgBox("File Does Not Exist")
        End If

    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Me.Hide()
        index.Show()
    End Sub

    Private Sub network_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Dim valueforscan As String
        If My.Computer.FileSystem.FileExists("default\net.txt") Then
            valueforscan = IO.File.ReadAllText("default\net.txt")
            ComboBox1.Text = valueforscan
            MessageBox.Show("Previous settings located", "Vuln Find")
        Else
            MessageBox.Show("Previous settings not located", "Vuln Find")
        End If
        MessageBox.Show("This component reqquires the use of Nmap", "Vuln Find")
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ComboBox1.SelectedIndexChanged

    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click

    End Sub
End Class